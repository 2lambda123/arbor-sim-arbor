language: cpp
sudo: false
os: linux
dist: trusty
compiler: gcc

addons:
    apt:
        sources:
            - ubuntu-toolchain-r-test
        packages:
            - g++-6
            - openmpi-bin
            - libopenmpi-dev

env:
    # test single node/rank with different threading back ends
    - BUILD_NAME=serial   WITH_THREAD=serial   WITH_DISTRIBUTED=serial
    - BUILD_NAME=cthread  WITH_THREAD=cthread  WITH_DISTRIBUTED=serial
    - BUILD_NAME=tbb      WITH_THREAD=tbb      WITH_DISTRIBUTED=serial
    # test mpi
    - BUILD_NAME=mpi      WITH_THREAD=cthread  WITH_DISTRIBUTED=mpi
    - BUILD_NAME=mpitbb   WITH_THREAD=tbb      WITH_DISTRIBUTED=mpi

before_install:
    - CC=gcc-6
    - CXX=g++-6

script: source ./scripts/travis/build.sh

