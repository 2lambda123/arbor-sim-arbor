Adapted from github.com:halfflat/optionalm
